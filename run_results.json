{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-30T12:27:07.878157Z", "invocation_id": "d4525463-a80e-42e1-868e-953cbe75cc24", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.826239Z", "completed_at": "2025-03-30T12:27:07.827245Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.827245Z", "completed_at": "2025-03-30T12:27:07.827245Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.001005411148071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_airbnb.demo_extractions", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.828244Z", "completed_at": "2025-03-30T12:27:07.831244Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.831244Z", "completed_at": "2025-03-30T12:27:07.831244Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003998756408691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb.dim__listings", "compiled": true, "compiled_code": "WITH  __dbt__cte__src__listings as (\nWITH raw_listings AS (\n    SELECT * FROM \"dev\".\"raw\".\"data_listings\"\n)\nSELECT \n   id AS listing_id,\n   listing_url,\n   name AS listing_name,\n   room_type,\n   minimum_nights,\n   host_id,\n   price\nFROM raw_listings\n), src__listings AS (\n  SELECT * FROM __dbt__cte__src__listings\n)\n\nSELECT\n  listing_id,\n  listing_name,\n  host_id,\n  CAST(REPLACE(REPLACE(price::text, '$', ''), ',', '') AS DECIMAL(10,2)) AS price\nFROM src__listings", "relation_name": "\"dev\".\"raw\".\"dim__listings\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.832244Z", "completed_at": "2025-03-30T12:27:07.839755Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.839755Z", "completed_at": "2025-03-30T12:27:07.839755Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007510662078857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb.fct__reviews", "compiled": true, "compiled_code": "\n\n\n\n\nWITH  __dbt__cte__src__reviews as (\nWITH raw_reviews AS (\n    SELECT * FROM \"dev\".\"raw\".\"data_reviews\"\n)\nSELECT\n    reviewer_id,\n    reviewer_name,\n    CAST(date AS DATE) AS review_date,\n    comments AS review_text,\n    listing_id\nFROM\n    raw_reviews\n), src_reviews AS (\n  SELECT *\n  FROM __dbt__cte__src__reviews\n)\n\nSELECT\n  md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id,\n  *\nFROM src_reviews\n\n    WHERE TRUE\n  \n    \n    AND review_date > (SELECT MAX(review_date) FROM \"dev\".\"raw\".\"fct__reviews\")\n  \n", "relation_name": "\"dev\".\"raw\".\"fct__reviews\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.840754Z", "completed_at": "2025-03-30T12:27:07.845756Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.845756Z", "completed_at": "2025-03-30T12:27:07.845756Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0060007572174072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb.not_null_dim__listings_listing_id.528897b0ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom \"dev\".\"raw\".\"dim__listings\"\nwhere listing_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.846755Z", "completed_at": "2025-03-30T12:27:07.848756Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.848756Z", "completed_at": "2025-03-30T12:27:07.848756Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0020008087158203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb.positive_value_dim__listings_price.88d9dfe50e", "compiled": true, "compiled_code": "\nSELECT\n    *\nFROM\n    \"dev\".\"raw\".\"dim__listings\"\nWHERE\n    price < 1\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.849756Z", "completed_at": "2025-03-30T12:27:07.853756Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.853756Z", "completed_at": "2025-03-30T12:27:07.853756Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003999948501586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb.unique_dim__listings_listing_id.395e4b3990", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    listing_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"raw\".\"dim__listings\"\nwhere listing_id is not null\ngroup by listing_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.854755Z", "completed_at": "2025-03-30T12:27:07.856811Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.856811Z", "completed_at": "2025-03-30T12:27:07.856811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002055644989013672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_airbnb.agg__guest_stats", "compiled": true, "compiled_code": "WITH reviews AS (\n  SELECT * FROM \"dev\".\"raw\".\"fct__reviews\"\n),\nlistings AS (\n  SELECT * FROM \"dev\".\"raw\".\"dim__listings\"\n),\nreview_intervals AS (\n  SELECT\n    reviewer_id,\n    AVG(diff_days) AS avg_time_between_stays\n  FROM (\n    SELECT\n      reviewer_id,\n      DATEDIFF('day',\n        LAG(review_date) OVER (PARTITION BY reviewer_id ORDER BY review_date),\n        review_date\n      ) AS diff_days\n    FROM reviews\n  ) sub\n  WHERE diff_days IS NOT NULL\n  GROUP BY reviewer_id\n)\nSELECT\n  r.reviewer_id,\n  COUNT(DISTINCT r.listing_id) AS stays,\n  AVG(l.price) AS price_per_night,\n  ri.avg_time_between_stays\nFROM reviews r\nLEFT JOIN listings l ON l.listing_id = r.listing_id\nLEFT JOIN review_intervals ri ON r.reviewer_id = ri.reviewer_id\nGROUP BY r.reviewer_id, ri.avg_time_between_stays", "relation_name": "\"dev\".\"raw\".\"agg__guest_stats\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.857815Z", "completed_at": "2025-03-30T12:27:07.859816Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.859816Z", "completed_at": "2025-03-30T12:27:07.859816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002001523971557617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb.not_null_fct__reviews_reviewer_id.c1796b2711", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reviewer_id\nfrom \"dev\".\"raw\".\"fct__reviews\"\nwhere reviewer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.860816Z", "completed_at": "2025-03-30T12:27:07.864815Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.864815Z", "completed_at": "2025-03-30T12:27:07.864815Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003999233245849609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb.relationships_fct__reviews_listing_id__listing_id__ref_dim__listings_.ee8e2ab02e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select listing_id as from_field\n    from \"dev\".\"raw\".\"fct__reviews\"\n    where listing_id is not null\n),\n\nparent as (\n    select listing_id as to_field\n    from \"dev\".\"raw\".\"dim__listings\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.865815Z", "completed_at": "2025-03-30T12:27:07.869155Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.869155Z", "completed_at": "2025-03-30T12:27:07.869155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033397674560546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb.dbt_expectations_expect_column_max_to_be_between_agg__guest_stats_price_per_night__5000.1b1f6a228f", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and max(price_per_night) <= 5000\n)\n as expression\n\n\n    from \"dev\".\"raw\".\"agg__guest_stats\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.870158Z", "completed_at": "2025-03-30T12:27:07.872159Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.873159Z", "completed_at": "2025-03-30T12:27:07.873159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030014514923095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb.not_null_agg__guest_stats_reviewer_id.65f97b1bc0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reviewer_id\nfrom \"dev\".\"raw\".\"agg__guest_stats\"\nwhere reviewer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-30T12:27:07.874159Z", "completed_at": "2025-03-30T12:27:07.876159Z"}, {"name": "execute", "started_at": "2025-03-30T12:27:07.876159Z", "completed_at": "2025-03-30T12:27:07.876159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002999544143676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_airbnb.unique_agg__guest_stats_reviewer_id.814ae32bb6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    reviewer_id as unique_field,\n    count(*) as n_records\n\nfrom \"dev\".\"raw\".\"agg__guest_stats\"\nwhere reviewer_id is not null\ngroup by reviewer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.1694638729095459, "args": {"partial_parse_file_diff": true, "version_check": true, "select": [], "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "strict_mode": false, "exclude": [], "empty_catalog": false, "log_format_file": "debug", "require_batched_execution_for_custom_microbatch_strategy": false, "log_path": "D:\\#Python\\insideairbnb_demo_project\\dbt_airbnb\\logs", "use_colors_file": true, "static": false, "show_resource_report": false, "skip_nodes_if_on_run_start_fails": false, "defer": false, "indirect_selection": "eager", "introspect": true, "printer_width": 80, "macro_debugging": false, "profiles_dir": "C:\\Users\\sergio\\.dbt", "require_yaml_configuration_for_mf_time_spines": false, "state_modified_compare_vars": false, "vars": {}, "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "which": "generate", "log_format": "default", "invocation_command": "dbt docs generate", "require_resource_names_without_spaces": false, "log_level": "info", "project_dir": "D:\\#Python\\insideairbnb_demo_project\\dbt_airbnb", "require_nested_cumulative_type_params": false, "print": true, "state_modified_compare_more_unrendered_values": false, "use_colors": true, "partial_parse": true, "write_json": true, "compile": true, "log_level_file": "debug", "static_parser": true, "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": false, "quiet": false, "favor_state": false, "populate_cache": true}}